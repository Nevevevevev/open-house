<!DOCTYPE html>
<html>
<head>
  <title>Insert via GET</title>
  <script src="https://code.jquery.com/jquery-3.6.3.min.js"></script>
  <style>
    form {
      display: flex;
      flex-direction: column;
      width: 300px;
      margin: 0 auto;
      border: 1px solid black;
      padding: 15px;
    }
    .radio-group div {
      display: flex;
      align-items: center;
      margin-bottom: 5px;
      margin-left: 30px;
      margin-top: 0px;
    }
    .radio-group label {
      margin-left: 8px;
    }
  </style>
</head>
<body>
  <center><h2>Everything with a * next to it is required</h2></center>
  <form onsubmit="insertRow(); return false;">
    <input type="text" id="col1" placeholder="Name *" required>
    <input type="text" id="col2" placeholder="Address">
    <input type="number" id="col3" placeholder="Cell Number *" required>
    <input type="email" id="col4" placeholder="Email *" required>

    <p style="margin-bottom: 0;">Needs *</p>
    <div class="radio-group">
      <div><input value="Looking to buy now" type="radio" id="col5a" name="needs" required><label for="col5a">Looking to buy now</label></div>
      <div><input vaue="Looking to buy within a year" type="radio" id="col5b" name="needs"><label for="col5b">Looking to buy within a year</label></div>
      <div><input value="Looking to sell" type="radio" id="col5c" name="needs"><label for="col5c">Looking to sell</label></div>
      <div><input value="Just shopping around" type="radio" id="col5d" name="needs"><label for="col5d">Just shopping around</label></div>
    </div>

    <label for="col6">Working with real estate agent: *</label>
    <input type="checkbox" id="col6">

    <label for="col7">Pre-qualified for home loan: *</label>
    <input type="checkbox" id="col7">

    <input type="submit" value="Submit">
  </form>

  <p id="response"></p>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbyhXJ9rCabg26cJJ-M-AHj9CHOqTq_1SMpNMgM_SmtXF0Lwnz0XC0FYj-kNRH1rm1_8/exec";

    function insertRow() {
      const col1 = encodeURIComponent(document.getElementById("col1").value);
      const col2 = encodeURIComponent(document.getElementById("col2").value);
      const col3 = encodeURIComponent(document.getElementById("col3").value);
      const col4 = encodeURIComponent(document.getElementById("col4").value);
      const col5 = encodeURIComponent($("input[name='needs']:checked").val());
      const col6 = document.getElementById("col6").checked ? "true" : "false";
      const col7 = document.getElementById("col7").checked ? "true" : "false";

      const url = `${API_URL}?col1=${col1}&col2=${col2}&col3=${col3}&col4=${col4}&col5=${col5}&col6=${col6}&col7=${col7}`;

      fetch(url)
        .then(response => response.text())
        .then(data => {
          alert("Form submitted successfully");
        })
        .catch(error => {
          alert("There was an error: " + error);
        });
    }
  </script>
</body>
</html>